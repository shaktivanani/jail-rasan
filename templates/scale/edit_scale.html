{% extends "base.html" %}

{% block content %}
<h2 class="mb-4">Edit Scale Entry</h2>

<form method="POST">
    <div class="form-row">
        <div class="form-group col-md-6">
            <label>Stock Item</label>
            <input type="text" class="form-control" 
                   value="{{ entry.stock_item.item_name }} ({{ entry.stock_item.unit }})" 
                   readonly>
            <input type="hidden" name="stock_item" value="{{ entry.stock_item_id }}">
        </div>
    </div>

    <div class="form-row">
        <div class="form-group col-md-3">
            <label for="start_date">Start Date</label>
            <input type="date" class="form-control" id="start_date" name="start_date" 
                   value="{{ entry.start_date.strftime('%Y-%m-%d') }}" required>
        </div>
        <div class="form-group col-md-3">
            <label for="end_date">End Date</label>
            <input type="date" class="form-control" id="end_date" name="end_date" 
                   value="{{ entry.end_date.strftime('%Y-%m-%d') }}" required>
        </div>
    </div>

    <div class="form-row">
        {% for day in ['monday', 'tuesday', 'wednesday', 'thursday', 'friday', 'saturday', 'sunday'] %}
        <div class="form-group col-md-1">
            <label>{{ day|title }}</label>
            <input type="number" step="0.001" class="form-control" 
                   name="{{ day }}" 
                   value="{{ "%.4f"|format(entry[day]) }}" 
                   required>
        </div>
        {% endfor %}
    </div>

    <button type="submit" class="btn btn-primary">Update Entry</button>
    <a href="{{ url_for('scale_list') }}" class="btn btn-secondary">Cancel</a>
</form>

<script>
// Date validation
document.querySelector('form').addEventListener('submit', function(e) {
    const startDate = new Date(document.getElementById('start_date').value);
    const endDate = new Date(document.getElementById('end_date').value);
    
    if (startDate > endDate) {
        alert('End date must be after start date!');
        e.preventDefault();
    }
});
</script>
{% endblock %}